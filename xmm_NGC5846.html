<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>1&period; start up</title>
        <style>
/* From extension koehlma.markdown-math */
@font-face{font-family:KaTeX_AMS;src:url(fonts/KaTeX_AMS-Regular.eot);src:url(fonts/KaTeX_AMS-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_AMS-Regular.woff2) format('woff2'),url(fonts/KaTeX_AMS-Regular.woff) format('woff'),url(fonts/KaTeX_AMS-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Bold.eot);src:url(fonts/KaTeX_Caligraphic-Bold.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Caligraphic-Bold.woff2) format('woff2'),url(fonts/KaTeX_Caligraphic-Bold.woff) format('woff'),url(fonts/KaTeX_Caligraphic-Bold.ttf) format('ttf');font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Regular.eot);src:url(fonts/KaTeX_Caligraphic-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Caligraphic-Regular.woff2) format('woff2'),url(fonts/KaTeX_Caligraphic-Regular.woff) format('woff'),url(fonts/KaTeX_Caligraphic-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Bold.eot);src:url(fonts/KaTeX_Fraktur-Bold.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Fraktur-Bold.woff2) format('woff2'),url(fonts/KaTeX_Fraktur-Bold.woff) format('woff'),url(fonts/KaTeX_Fraktur-Bold.ttf) format('ttf');font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Regular.eot);src:url(fonts/KaTeX_Fraktur-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Fraktur-Regular.woff2) format('woff2'),url(fonts/KaTeX_Fraktur-Regular.woff) format('woff'),url(fonts/KaTeX_Fraktur-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Bold.eot);src:url(fonts/KaTeX_Main-Bold.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Main-Bold.woff2) format('woff2'),url(fonts/KaTeX_Main-Bold.woff) format('woff'),url(fonts/KaTeX_Main-Bold.ttf) format('ttf');font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Italic.eot);src:url(fonts/KaTeX_Main-Italic.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Main-Italic.woff2) format('woff2'),url(fonts/KaTeX_Main-Italic.woff) format('woff'),url(fonts/KaTeX_Main-Italic.ttf) format('ttf');font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Regular.eot);src:url(fonts/KaTeX_Main-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Main-Regular.woff2) format('woff2'),url(fonts/KaTeX_Main-Regular.woff) format('woff'),url(fonts/KaTeX_Main-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-Italic.eot);src:url(fonts/KaTeX_Math-Italic.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Math-Italic.woff2) format('woff2'),url(fonts/KaTeX_Math-Italic.woff) format('woff'),url(fonts/KaTeX_Math-Italic.ttf) format('ttf');font-weight:400;font-style:italic}@font-face{font-family:KaTeX_SansSerif;src:url(fonts/KaTeX_SansSerif-Regular.eot);src:url(fonts/KaTeX_SansSerif-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_SansSerif-Regular.woff2) format('woff2'),url(fonts/KaTeX_SansSerif-Regular.woff) format('woff'),url(fonts/KaTeX_SansSerif-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Script;src:url(fonts/KaTeX_Script-Regular.eot);src:url(fonts/KaTeX_Script-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Script-Regular.woff2) format('woff2'),url(fonts/KaTeX_Script-Regular.woff) format('woff'),url(fonts/KaTeX_Script-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size1;src:url(fonts/KaTeX_Size1-Regular.eot);src:url(fonts/KaTeX_Size1-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Size1-Regular.woff2) format('woff2'),url(fonts/KaTeX_Size1-Regular.woff) format('woff'),url(fonts/KaTeX_Size1-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size2;src:url(fonts/KaTeX_Size2-Regular.eot);src:url(fonts/KaTeX_Size2-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Size2-Regular.woff2) format('woff2'),url(fonts/KaTeX_Size2-Regular.woff) format('woff'),url(fonts/KaTeX_Size2-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size3;src:url(fonts/KaTeX_Size3-Regular.eot);src:url(fonts/KaTeX_Size3-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Size3-Regular.woff2) format('woff2'),url(fonts/KaTeX_Size3-Regular.woff) format('woff'),url(fonts/KaTeX_Size3-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url(fonts/KaTeX_Size4-Regular.eot);src:url(fonts/KaTeX_Size4-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Size4-Regular.woff2) format('woff2'),url(fonts/KaTeX_Size4-Regular.woff) format('woff'),url(fonts/KaTeX_Size4-Regular.ttf) format('ttf');font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Typewriter;src:url(fonts/KaTeX_Typewriter-Regular.eot);src:url(fonts/KaTeX_Typewriter-Regular.eot#iefix) format('embedded-opentype'),url(fonts/KaTeX_Typewriter-Regular.woff2) format('woff2'),url(fonts/KaTeX_Typewriter-Regular.woff) format('woff'),url(fonts/KaTeX_Typewriter-Regular.ttf) format('ttf');font-weight:400;font-style:normal}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:inline-block;text-align:initial}.katex{font:400 1.21em KaTeX_Main;line-height:1.2;white-space:nowrap;text-indent:0}.katex .katex-html{display:inline-block}.katex .katex-mathml{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}.katex .base,.katex .strut{display:inline-block}.katex .mathit{font-family:KaTeX_Math;font-style:italic}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .amsrm,.katex .mathbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr{font-family:KaTeX_Script}.katex .mathsf{font-family:KaTeX_SansSerif}.katex .mainit{font-family:KaTeX_Main;font-style:italic}.katex .textstyle>.mord+.mop{margin-left:.16667em}.katex .textstyle>.mord+.mbin{margin-left:.22222em}.katex .textstyle>.mord+.mrel{margin-left:.27778em}.katex .textstyle>.mop+.mop,.katex .textstyle>.mop+.mord,.katex .textstyle>.mord+.minner{margin-left:.16667em}.katex .textstyle>.mop+.mrel{margin-left:.27778em}.katex .textstyle>.mop+.minner{margin-left:.16667em}.katex .textstyle>.mbin+.minner,.katex .textstyle>.mbin+.mop,.katex .textstyle>.mbin+.mopen,.katex .textstyle>.mbin+.mord{margin-left:.22222em}.katex .textstyle>.mrel+.minner,.katex .textstyle>.mrel+.mop,.katex .textstyle>.mrel+.mopen,.katex .textstyle>.mrel+.mord{margin-left:.27778em}.katex .textstyle>.mclose+.mop{margin-left:.16667em}.katex .textstyle>.mclose+.mbin{margin-left:.22222em}.katex .textstyle>.mclose+.mrel{margin-left:.27778em}.katex .textstyle>.mclose+.minner,.katex .textstyle>.minner+.mop,.katex .textstyle>.minner+.mord,.katex .textstyle>.mpunct+.mclose,.katex .textstyle>.mpunct+.minner,.katex .textstyle>.mpunct+.mop,.katex .textstyle>.mpunct+.mopen,.katex .textstyle>.mpunct+.mord,.katex .textstyle>.mpunct+.mpunct,.katex .textstyle>.mpunct+.mrel{margin-left:.16667em}.katex .textstyle>.minner+.mbin{margin-left:.22222em}.katex .textstyle>.minner+.mrel{margin-left:.27778em}.katex .mclose+.mop,.katex .minner+.mop,.katex .mop+.mop,.katex .mop+.mord,.katex .mord+.mop,.katex .textstyle>.minner+.minner,.katex .textstyle>.minner+.mopen,.katex .textstyle>.minner+.mpunct{margin-left:.16667em}.katex .reset-textstyle.textstyle{font-size:1em}.katex .reset-textstyle.scriptstyle{font-size:.7em}.katex .reset-textstyle.scriptscriptstyle{font-size:.5em}.katex .reset-scriptstyle.textstyle{font-size:1.42857em}.katex .reset-scriptstyle.scriptstyle{font-size:1em}.katex .reset-scriptstyle.scriptscriptstyle{font-size:.71429em}.katex .reset-scriptscriptstyle.textstyle{font-size:2em}.katex .reset-scriptscriptstyle.scriptstyle{font-size:1.4em}.katex .reset-scriptscriptstyle.scriptscriptstyle{font-size:1em}.katex .style-wrap{position:relative}.katex .vlist{display:inline-block}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist .baseline-fix{display:inline-table;table-layout:fixed}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{width:100%}.katex .mfrac .frac-line:before{border-bottom-style:solid;border-bottom-width:1px;content:"";display:block}.katex .mfrac .frac-line:after{border-bottom-style:solid;border-bottom-width:.04em;content:"";display:block;margin-top:-1px}.katex .mspace{display:inline-block}.katex .mspace.negativethinspace{margin-left:-.16667em}.katex .mspace.thinspace{width:.16667em}.katex .mspace.mediumspace{width:.22222em}.katex .mspace.thickspace{width:.27778em}.katex .mspace.enspace{width:.5em}.katex .mspace.quad{width:1em}.katex .mspace.qquad{width:2em}.katex .llap,.katex .rlap{width:0;position:relative}.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .rlap>.inner{left:0}.katex .katex-logo .a{font-size:.75em;margin-left:-.32em;position:relative;top:-.2em}.katex .katex-logo .t{margin-left:-.23em}.katex .katex-logo .e{margin-left:-.1667em;position:relative;top:.2155em}.katex .katex-logo .x{margin-left:-.125em}.katex .rule{display:inline-block;border:0 solid;position:relative}.katex .overline .overline-line,.katex .underline .underline-line{width:100%}.katex .overline .overline-line:before,.katex .underline .underline-line:before{border-bottom-style:solid;border-bottom-width:1px;content:"";display:block}.katex .overline .overline-line:after,.katex .underline .underline-line:after{border-bottom-style:solid;border-bottom-width:.04em;content:"";display:block;margin-top:-1px}.katex .sqrt>.sqrt-sign{position:relative}.katex .sqrt .sqrt-line{width:100%}.katex .sqrt .sqrt-line:before{border-bottom-style:solid;border-bottom-width:1px;content:"";display:block}.katex .sqrt .sqrt-line:after{border-bottom-style:solid;border-bottom-width:.04em;content:"";display:block;margin-top:-1px}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer,.katex .sizing{display:inline-block}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:2em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:3.46em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:4.14em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.98em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.47142857em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.95714286em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.55714286em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.875em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.125em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.25em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.5em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.8em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.1625em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.5875em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:3.1125em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.77777778em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.88888889em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.6em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.92222222em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.3em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.76666667em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.7em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.8em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.9em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.2em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.44em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.73em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:2.07em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.49em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.58333333em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.66666667em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.75em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.83333333em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44166667em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.725em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.075em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.48611111em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.55555556em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.625em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.69444444em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.20138889em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.4375em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72916667em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.28901734em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.40462428em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.46242775em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.52023121em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.57803468em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69364162em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83236994em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.19653179em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.43930636em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.24154589em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.33816425em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.38647343em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.43478261em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.48309179em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.57971014em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69565217em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83574879em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20289855em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.20080321em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.2811245em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.32128514em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.36144578em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.40160643em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48192771em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57831325em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69477912em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.8313253em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist>span,.katex .op-limits>.vlist>span{text-align:center}.katex .accent .accent-body>span{width:0}.katex .accent .accent-body.accent-vec>span{position:relative;left:.326em}.katex .mtable .vertical-separator{display:inline-block;margin:0 -.025em;border-right:.05em solid #000}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist{text-align:center}.katex .mtable .col-align-l>.vlist{text-align:left}.katex .mtable .col-align-r>.vlist{text-align:right}
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <pre><code class="language-bash"><div>heainit
sasinit  /顺序不可错/i

<span class="hljs-built_in">echo</span> <span class="hljs-variable">$LD_LIBRARY_PATH</span>   /检查xmm路径/
exp: /usr/<span class="hljs-built_in">local</span>/xmm/xmmsas_20141104_1833/libsys:/usr/<span class="hljs-built_in">local</span>/xmm/xmmsas_20141104_1833/libextra:/usr/<span class="hljs-built_in">local</span>/xmm/xmmsas_20141104_1833/lib

<span class="hljs-built_in">echo</span> <span class="hljs-variable">$SAS_CCF</span> <span class="hljs-variable">$SAS_ODF</span>
</div></code></pre>
<pre><code><code><div>dirs structure:
- XMM/
    - 0723800201/
        - ODF/
            - ... observational data files
        - PROC/
            - epsfilt/
                - processed_fits files
    - obsid2/
        - ...
</div></code></code></pre>
<p>目录</p>
<ul>
<li><a href="#1-start-up">1. start up</a></li>
<li><a href="#2-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86">2. 后续处理</a>
<ul>
<li><a href="#21-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86-%E6%A3%80%E6%9F%A5%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">2.1. 后续处理-检查环境变量</a></li>
<li><a href="#22-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86-%E5%A4%84%E7%90%86%E5%85%89%E5%8F%98--lightcurve-clear-flare">2.2. 后续处理-处理光变  lightcurve clear flare</a></li>
<li><a href="#23-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86-%E5%A4%84%E7%90%86%E7%82%B9%E6%BA%90%E6%89%A3%E7%82%B9%E6%BA%90exclude-source-point">2.3. 后续处理-处理点源（扣点源）exclude source point</a>
<ul>
<li><a href="#231-%E7%94%9F%E6%88%90image%E7%94%A8%E4%BA%8Edetect-%E5%8F%AF%E4%BB%A5%E7%94%A8mospn-filter-%E7%9A%84img%E5%8F%AF%E8%B7%B3%E8%BF%87">2.3.1. 生成image用于detect （可以用mos/pn-filter 的img，可跳过）</a></li>
<li><a href="#232-%E5%BC%80%E5%A7%8Bdetection">2.3.2. 开始detection</a></li>
<li><a href="#233-%E6%89%A3%E7%82%B9%E6%BA%90%E7%94%9F%E6%88%90cleanfits%E7%94%A8sas-gui%E4%B8%AD%E7%9A%84xmmselect">2.3.3. 扣点源生成clean.fits，用sas gui中的xmmselect</a></li>
</ul>
</li>
<li><a href="#24-generate-full-image-and-corn-image-for-mospn-spectra">2.4. generate full image and corn image for mos/pn-spectra</a></li>
</ul>
</li>
<li><a href="#3-%E5%8D%95%E4%B8%AA%E5%85%89%E8%B0%B1%E6%8F%90%E5%8F%96">3. 单个光谱提取</a>
<ul>
<li><a href="#31-%E5%8D%95%E4%B8%AA%E5%85%89%E8%B0%B1%E6%8F%90%E5%8F%96">3.1. 单个光谱提取</a></li>
</ul>
</li>
<li><a href="#4-%E6%9C%89%E6%96%B9%E5%90%91%E6%80%A7%E7%9A%84%E5%BE%84%E5%90%91%E5%85%89%E8%B0%B1%E5%A4%9A%E5%8C%BA%E5%9F%9F%E6%8F%90%E5%8F%96%E5%85%89%E8%B0%B1">4. 有方向性的径向光谱/多区域提取光谱</a>
<ul>
<li><a href="#41-xmm-radial-spectrum">4.1. XMM Radial spectrum</a></li>
</ul>
</li>
<li><a href="#5-%E8%83%8C%E6%99%AF%E5%85%89%E8%B0%B1%E4%BF%AE%E6%AD%A3">5. 背景光谱修正</a></li>
</ul>
<h1 id="1-start-up">1. start up</h1>
<p>使用fsd学长的脚本：xmm_init_process.sh</p>
<p>其步骤大概是</p>
<ol>
<li>解压odf文件到ODF目录</li>
<li>run cifbuild, odfingest,</li>
<li>emchain, mos-filter, epchain, pn-filter</li>
</ol>
<p>U might get rid of unused intermediate files.</p>
<pre><code class="language-bash"><div><span class="hljs-built_in">cd</span> PROC/epsfilt
rm -f *FIT
</div></code></pre>
<hr>
<h1 id="2-后续处理">2. 后续处理</h1>
<h2 id="21-后续处理-检查环境变量">2.1. 后续处理-检查环境变量</h2>
<p>#当进入一个已经经过startup处理的文件夹，然后确定基本变量SAS_CCF，SAS_ODF有无设定，若无，就要先设定
#也可以用sasversion检查</p>
<p>sasversion</p>
<p>Ex. output</p>
<pre><code>sasversion:- Executing (routine): sasversion  -w 1 -V 4
sasversion:- sasversion (sasversion-1.3)  [xmmsas_20201028_0905-19.0.0] started:  2021-02-15T02:16:34.000
sasversion:- XMM-Newton SAS release and build information:

SAS release: xmmsas_20201028_0905-19.0.0
Compiled on: Wed Oct 28 10:07:26 CET 2020
Compiled by: sasbuild@sasbld03n
Platform   : Ubuntu18.04

SAS-related environment variables that are set:

SAS_DIR = /home/siewhoongwah/linuxpart/Software/SAS/xmmsas_20201028_0905
SAS_PATH = /home/siewhoongwah/linuxpart/Software/SAS/xmmsas_20201028_0905
SAS_CCFPATH = /home/siewhoongwah/linuxpart/Software/SAS/ccf
SAS_CCF = /mnt/D/science_research/start/XMM/0723800201/ccf.cif
SAS_ODF = /mnt/D/science_research/start/XMM/0723800201/2584_0723800201_SCX00000SUM.SAS

sasversion:- sasversion (sasversion-1.3)  [xmmsas_20201028_0905-19.0.0] ended:    2021-02-15T02:16:34.000

Do not forget to define SAS_CCFPATH, SAS_CCF and SAS_ODF
</code></pre>
<p>具体目录结构见dirs structure。</p>
<pre><code class="language-bash"><div>cat &gt;setup.sh &lt;EOF  <span class="hljs-comment">## 写一个setup脚本每次开启终端可以直接setup</span>
<span class="hljs-built_in">cd</span> xxxx/[obsid]
<span class="hljs-built_in">export</span> SAS_CCF=`readlink -f ./ccf.cif` 
<span class="hljs-built_in">export</span> SAS_ODP=`readlink -f ./*SUM.SAS`
<span class="hljs-built_in">export</span> SAS_ESAS_CALDB=<span class="hljs-string">&quot;<span class="hljs-variable">${yourPath}</span>/esas_calbd&quot;</span>
EOF
</div></code></pre>
<p>#根据需要定义变量，比如OBSID=xxxxxx, SAS_ESAS_CALDB见后面内容。</p>
<pre><code class="language-bash"><div><span class="hljs-built_in">source</span> setup.sh   <span class="hljs-comment">## 可以把该脚本放到path里面，以后直接调用</span>
</div></code></pre>
<p>#改一下名字</p>
<pre><code class="language-bash"><div>mv mos1S001-clean.fits mos1S001-ori.fits
mv mos2S002-clean.fits mos2S002-ori.fits
mv pnS003-clean.fits pnS003-ori.fits
mv pnS003-clean-oot.fits pnS003-oot-ori.fits
</div></code></pre>
<hr>
<h2 id="22-后续处理-处理光变--lightcurve-clear-flare">2.2. 后续处理-处理光变  lightcurve clear flare</h2>
<p>#一般不用做这个直接扣点源，em/ep-filter 做了.<br>
url: <a href="https://www.cosmos.esa.int/web/xmm-newton/sas-thread-epic-filterbackground">https://www.cosmos.esa.int/web/xmm-newton/sas-thread-epic-filterbackground</a></p>
<ol>
<li>提取高能段光变曲线</li>
</ol>
<pre><code class="language-bash"><div>evselect table=mos1S001-ori.fits withrateset=Y rateset=mos1S001.lc maketimecolumn=Y timebinsize=100 makeratecolumn=Y expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PI&gt;10000) &amp;&amp; (PATTERN==0)&#x27;</span> updateexposure=yes filterexposure=yes

evselect table=mos2S002-ori.fits withrateset=Y rateset=mos2S002.lc maketimecolumn=Y timebinsize=100 makeratecolumn=Y expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PI&gt;10000) &amp;&amp; (PATTERN==0)&#x27;</span> updateexposure=yes filterexposure=yes

evselect table=pnS003-ori.fits withrateset=Y rateset=pnS003.lc maketimecolumn=Y timebinsize=100 makeratecolumn=Y expression=<span class="hljs-string">&#x27;#XMMEA_EP &amp;&amp; (PI&gt;10000&amp;&amp;PI&lt;12000) &amp;&amp; (PATTERN==0)&#x27;</span> updateexposure=yes filterexposure=yes

evselect table=pnS003-oot-ori.fits withrateset=yes rateset=pnS003-oot.lc maketimecolumn=yes timebinsize=100 makeratecolumn=yes expression=<span class="hljs-string">&#x27;#XMMEA_EP &amp;&amp; (PI&gt;10000&amp;&amp;PI&lt;12000) &amp;&amp; (PATTERN==0)&#x27;</span> updateexposure=yes filterexposure=yes
</div></code></pre>
<p>#expression 中的#XMMEA的表达可以参考：<a href="https://www.ocf.berkeley.edu/~atran">https://www.ocf.berkeley.edu/~atran</a></p>
<pre><code class="language-bash"><div>dsplot table=mos1S001.lc x=TIME y=RATE  
</div></code></pre>
<p>#mos2,pn 也看一下，以便自定RATE的expression</p>
<ol start="2">
<li>generate gti</li>
</ol>
<pre><code class="language-bash"><div>tabgtigen table=mos1S001.lc expression=<span class="hljs-string">&#x27;RATE&lt;=0.15&#x27;</span> gtiset=mos1S001.gti
tabgtigen table=mos2S002.lc expression=<span class="hljs-string">&#x27;RATE&lt;=0.2&#x27;</span> gtiset=mos2S002.gti
tabgtigen table=pnS003.lc expression=<span class="hljs-string">&#x27;RATE&lt;=0.27&#x27;</span> gtiset=pnS003.gti
tabgtigen table=pnS003-oot.lc expression=<span class="hljs-string">&#x27;RATE&lt;=0.27&#x27;</span> gtiset=pnS003-oot.gti
</div></code></pre>
<ol start="3">
<li>filter table</li>
</ol>
<pre><code class="language-bash"><div>evselect table=mos1S001-ori.fits withfilteredset=Y filteredset=mos1S001-lcfilt.fits keepfilteroutput=T expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; gti(mos1S001.gti,TIME) &amp;&amp; (PI in [200:12000])&#x27;</span>

evselect table=mos2S002-ori.fits withfilteredset=Y filteredset=mos2S002-lcfilt.fits keepfilteroutput=T expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; gti(mos2S002.gti,TIME) &amp;&amp; (PI in [200:12000])&#x27;</span>

evselect table=pnS003-ori.fits withfilteredset=Y filteredset=pnS003-lcfilt.fits keepfilteroutput=T expression=<span class="hljs-string">&#x27;#XMMEA_EP &amp;&amp; gti(pnS003.gti,TIME) &amp;&amp; (PI in [200:15000])&#x27;</span>

evselect table=pnS003-oot-ori.fits withfilteredset=Y filteredset=pnS003-oot-lcfilt.fits keepfilteroutput=T expression=<span class="hljs-string">&#x27;#XMMEA_EP &amp;&amp; gti(pnS003-oot.gti,TIME) &amp;&amp; (PI in [200:15000])&#x27;</span>
</div></code></pre>
<p>接下来，如果要用cheese扣点源需要改变一下命名，cheese对命名有要求。event文件要改成xxx-clean.fits，可参考xmm-esas-v5.9.pdf.
#注意cheese-bands命令已经没有了（sas v19以上），功能被cheese包含了。</p>
<hr>
<h2 id="23-后续处理-处理点源扣点源exclude-source-point">2.3. 后续处理-处理点源（扣点源）exclude source point</h2>
<p>首先，XMM找点源有很多方法，其中有<code>edetect_chain</code>(url: <a href="https://www.cosmos.esa.int/web/xmm-newton/sas-thread-src-find">https://www.cosmos.esa.int/web/xmm-newton/sas-thread-src-find</a>)，用<code>cheese</code>(参考：xmm-esas-v5.9.pdf)。也可以用ciao的celldetect + 手动找，最后用sas的GUI中的xmmselect扣。**注意XMM的脚本cheese貌似需要跑挺久。</p>
<h3 id="231-生成image用于detect-可以用mospn-filter-的img可跳过">2.3.1. 生成image用于detect （可以用mos/pn-filter 的img，可跳过）</h3>
<p>#(可以用 em/ep-filter 生成的图片*obj-im-det.fits,类似这样的，反正只是找源。)<br>
#也可以直接用 xmmselect gui 手动找源（跳过图片生成这步）<br>
#所以2.3.1可以不做。生成图片可以在扣了点源后<br>
#generate physical/POS 坐标的image</p>
<pre><code class="language-bash"><div>evselect table=mos1S001-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;m1_image.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;X&#x27;</span> ycolumn=<span class="hljs-string">&#x27;Y&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EM&amp;&amp;(PI in [200:12000])&amp;&amp;(PATTERN in [0:12])&amp;&amp;(FLAG==0)&#x27;</span>

evselect table=mos2S002-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;m2_image.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;X&#x27;</span> ycolumn=<span class="hljs-string">&#x27;Y&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PI in [200:12000])&amp;&amp;(PATTERN in [0:12])&amp;&amp;(FLAG==0)&#x27;</span>

evselect table=pnS003-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;pn_image.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;X&#x27;</span> ycolumn=<span class="hljs-string">&#x27;Y&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EP&amp;&amp;(PI in [300:12000])&amp;&amp;(PATTERN in [0:4])&amp;&amp;(FLAG==0)&#x27;</span>   <span class="hljs-comment">## 注意PN的pattern只要0：4</span>

evselect table=pnS003-oot-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;pn_oot_image.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;X&#x27;</span> ycolumn=<span class="hljs-string">&#x27;Y&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EP&amp;&amp;(PI in [300:12000])&amp;&amp;(PATTERN in [0:4])&amp;&amp;(FLAG==0)&#x27;</span>
</div></code></pre>
<p>#generate det 坐标的image</p>
<pre><code class="language-bash"><div>evselect table=mos1S001-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;m1_image-det.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;DETX&#x27;</span> ycolumn=<span class="hljs-string">&#x27;DETY&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EM&amp;&amp;(PI in [200:12000])&amp;&amp;(PATTERN in [0:12])&#x27;</span>

evselect table=mos2S002-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;m2_image-det.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;DETX&#x27;</span> ycolumn=<span class="hljs-string">&#x27;DETY&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PI in [200:12000])&amp;&amp;(PATTERN in [0:12])&#x27;</span>

evselect table=pnS003-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;pn_image-det.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;DETX&#x27;</span> ycolumn=<span class="hljs-string">&#x27;DETY&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EP&amp;&amp;(PI in [300:15000])&amp;&amp;(PATTERN in [0:4])&#x27;</span>   <span class="hljs-comment">## 注意PN的pattern只要0：4</span>

evselect table=pnS003-oot-lcfilt.fits:EVENTS imagebinning=<span class="hljs-string">&#x27;binSize&#x27;</span> imageset=<span class="hljs-string">&#x27;pn_oot_im-det.fits&#x27;</span> withimageset=yes xcolumn=<span class="hljs-string">&#x27;DETX&#x27;</span> ycolumn=<span class="hljs-string">&#x27;DETY&#x27;</span> ximagebinsize=32 yimagebinsize=32 expression=<span class="hljs-string">&#x27;#XMMEA_EP&amp;&amp;(PI in [300:15000])&amp;&amp;(PATTERN in [0:4])&#x27;</span>
</div></code></pre>
<h3 id="232-开始detection">2.3.2. 开始detection</h3>
<p><code>ds9 -&gt; analysis-&gt; ciao tools-&gt; detect-&gt; wavdetect -&gt; save region</code><br>
or</p>
<pre><code class="language-bash"><div>celldetect  infile=<span class="hljs-string">&quot;mos1S001-obj-image-det.fits&quot;</span> outfile=<span class="hljs-string">&quot;m1_celld-det.fits&quot;</span> regfile=m1_celld-det.reg fixedcell=12 clob+
celldetect  infile=<span class="hljs-string">&quot;mos2S002-obj-image-det.fits&quot;</span> outfile=<span class="hljs-string">&quot;m2_celld-det.fits&quot;</span> regfile=m2_celld-det.reg fixedcell=12 clob+
celldetect  infile=<span class="hljs-string">&quot;pnS003-obj-image-det.fits&quot;</span> outfile=<span class="hljs-string">&quot;pn_celld-det.fits&quot;</span> regfile=pn_celld-det.reg fixedcell=12 clob+
</div></code></pre>
<p>##pn_celld.reg的可能没什么什么用，因为他over exposure的pixel很多。再想想怎么解决。
##Note: celldetect 要自己调一下参数，具体自己查阅网上资料，最好玩还是自己用sas xmmselect看图扣。</p>
<h3 id="233-扣点源生成cleanfits用sas-gui中的xmmselect">2.3.3. 扣点源生成clean.fits，用sas gui中的xmmselect</h3>
<ol>
<li>
<p>打开xmm的gui<br>
<code>输入sas -&gt; 选择xmmselect -&gt;挑选events file</code><br>
或<br>
<code>xmmselect table=mos1S001-lcfilt.fits:EVENTS &amp;  </code></p>
</li>
<li>
<p>在column selection中选择打勾<code>DETX</code>,<code>DETY</code>（<code>X</code>,<code>Y</code>意思就是用wcs的坐标，<code>DETX</code>,<code>DETY</code>是探测器坐标，这里<code>celldetect</code>保存的是DET的坐标），然后选择下面的image选项，这会开启<code>evselect</code>的gui，然后可以在image项目栏里调整要显示的image bin size等，接着点击run，就会打开一个ds9的窗口来显示图片。</p>
</li>
</ol>
<ul>
<li>Note: 用<code>DETXY</code>来扣因为现在<code>sas</code>的<code>arfgen</code>只能接受<code>DETXY</code>，所以统一都用<code>DETXY</code>。</li>
</ul>
<ol start="3">
<li>
<p>在<code>ds9</code>里load之前的<code>celldetect</code>产生的xx_celld.reg文件，然后根据肉眼修改，比如目标源上的圈圈要去掉等。</p>
</li>
<li>
<p>确认要扣掉的点源后点击<code>xmmselect</code> gui中的<code>2Dregion</code>，然后expression那边就会自动写好选择的区域。注意！但是我们要扣掉他们所以要在expression的前面加个&quot;<code>！</code>&quot;。</p>
<p>Eg:</p>
<pre><code><code><div>!(((X,Y) IN ellipse(13850,19690.5,331.224,269.616,59.9203)||(X,Y) IN  ellipse(38457.4,30495.4,314.448,236.16,116.937)))
</div></code></code></pre>
</li>
<li>
<p>然后，点击filterd table-&gt;修改filteredset那栏的output name，最后Run就可以了。最后可以命名为 mos1S001-clean.fits</p>
</li>
</ol>
<p>#查看cleaned的eventfile</p>
<pre><code><code><div>ds9 *clean2* -scale log -scale match -bin factor 32 -bin match &amp;
</div></code></code></pre>
<h2 id="24-generate-full-image-and-corn-image-for-mospn-spectra">2.4. generate full image and corn image for mos/pn-spectra</h2>
<p>#如果没有这些image，mos/pn-spectra好像会自己生成。所以应该可以不用做，除非特殊情况。<br>
corn，full image 的定义要查mos-spectra 或者 back的脚本，看xmm团队的定义。<br>
corn就是角落的，所以是要扣掉中间的一个区域，用DETX,DETY来扣。</p>
<pre><code class="language-bash"><div>evselect table=mos2S002-clean.fits withimageset=yes imageset=mos2S002-obj-image-det.fits xcolumn=<span class="hljs-string">&#x27;DETX&#x27;</span> ximagesize=780 ximagemax=19500 ximagemin=-19499 ycolumn=<span class="hljs-string">&#x27;DETY&#x27;</span> yimagesize=780 yimagemax=19500 yimagemin=-19499 imagebinning=imageSize ignorelegallimits=yes
</div></code></pre>
<p>mos corndef : ...<br>
mos corndefa: ...<br>
mos fov     : ...</p>
<p>pn corndef  : ...<br>
pn corndefa : ...<br>
pn fov      : ...</p>
<hr>
<h1 id="3-单个光谱提取">3. 单个光谱提取</h1>
<p>#参考 <a href="https://www.cosmos.esa.int/web/xmm-newton/sas-thread-mos-spectrum">https://www.cosmos.esa.int/web/xmm-newton/sas-thread-mos-spectrum</a>
#XMM中的POS坐标就是ds9的physical坐标。</p>
<p>##手动提取光谱（未完善，有bug）<br>
可skip{{</p>
<pre><code class="language-bash"><div>evselect table=mos1S001-clean.fits:EVENTS withfilteredset=yes expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PATTERN&lt;=12) &amp;&amp; ((DETX,DETY) IN circle(222,-219,2400))&#x27;</span> filtertype=expression keepfilteroutput=no withspectrumset=yes spectrumset=mos1S001-obj.pi energycolumn=PI spectralbinsize=5 withspecranges=yes specchannelmin=0 specchannelmax=11999

(X,Y) IN circle(25231.248,24012.621,2400)

evselect table=mos1S001-clean.fits:EVENTS withfilteredset=yes expression=<span class="hljs-string">&#x27;(X,Y) IN circle(25231.248,24012.621,2400)&#x27;</span> filtertype=expression keepfilteroutput=no  withspectrumset=yes spectrumset=mos1S001-obj.pi energycolumn=PI spectralbinsize=5 withspecranges=yes specchannelmin=0 specchannelmax=11999

evselect table=mos1S001-clean.fits:EVENTS withfilteredset=yes expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PATTERN&lt;=12) &amp;&amp; (((DETX,DETY) IN pie(222,-219,0.0,10.0)) &amp;&amp; ((DETX,DETY) IN annulus(222.0,-219.0,600,1200)))&#x27;</span> filtertype=expression keepfilteroutput=yes filteredset=mos1pie.fits  withspectrumset=yes spectrumset=mos1S001-obj-120-150.pi energycolumn=PI spectralbinsize=5 withspecranges=yes specchannelmin=0 specchannelmax=11999(DETX,DETY)

evselect table=mos1S001-ori.fits:EVENTS withfilteredset=yes expression=<span class="hljs-string">&#x27;#XMMEA_EM &amp;&amp; (PATTERN&lt;=12) &amp;&amp; (((DETX,DETY) IN pie(222,-219,0.0,10.0)) &amp;&amp; ((DETX,DETY) IN annulus(222.0,-219.0,600,1200)))&#x27;</span> filtertype=expression keepfilteroutput=yes filteredset=mos1pie.fits  withspectrumset=yes spectrumset=mos1S001-obj-ori-120-150.pi energycolumn=PI spectralbinsize=5 withspecranges=yes specchannelmin=0 specchannelmax=11999

backscale spectrumset=mos1S001-obj.pi badpixlocation=mos1S001-clean.fits withbadpixcorr=yes
</div></code></pre>
<p>#responese file.<br>
url: <a href="https://heasarc.gsfc.nasa.gov/docs/xmm/sas/USG/epicresponsefiles.html">https://heasarc.gsfc.nasa.gov/docs/xmm/sas/USG/epicresponsefiles.html</a></p>
<pre><code class="language-bash"><div>rmfgen spectrumset=mos1S001-obj.pi rmfset=mos1S001-obj.rmf detxbins=160 detybins=160

arfgen spectrumset=spectrum.pha detmaptype=dataset detmaparray=<span class="hljs-string">&#x27;detmap.ds&#x27;</span> withrmfset=<span class="hljs-literal">true</span> rmfset=m1_r5_all_15.rmf extendedsource=yes setbackscale=yes

arfgen spectrumset=mos1S001-obj.pi arfset=mos1S001-obg.arf detmaptype=dataset detmaparray=<span class="hljs-string">&#x27;pnS003-im-sky.fits&#x27;</span> withrmfset=<span class="hljs-literal">true</span> rmfset=mos1S001-obj.rmf extendedsource=yes badpixlocation=mos1S001-obj.pi setbackscale=yes
arfgen spectrumset=spectrum.pha setbackscale=yes
</div></code></pre>
<p>}}}skip</p>
<ul>
<li>Recommend to use mos/pn-spectra 来生成光谱。因为它可以顺便生成quite particle background(QPB)背景光谱的文件。配合mos/pn-back可以得到脚本修正的背景光谱，要自己修正要用xspec。</li>
</ul>
<h2 id="31-单个光谱提取">3.1. 单个光谱提取</h2>
<ol>
<li>需要一个目标obj区域文件，已filter expression的格式。</li>
</ol>
<pre><code><code><div>reg-0-30.txt: &amp;&amp;((DETX,DETY) IN circle(222.0,-219.0,600))
reg-30-60.txt: &amp;&amp;((DETX,DETY) IN circle(222.0,-219.0,1200))&amp;&amp;!((DETX,DETY) IN circle(222.0,-219.0,600))
reg-30-60.txt: &amp;&amp;((X,Y) IN circle(25231.248,24012.621,1200))&amp;&amp;!((X,Y) IN circle(25231.248,24012.621,600))
</div></code></code></pre>
<p>Note</p>
<ul>
<li>need to download FWC files(NOt really)? mos1-fwc.fits.gz? and put in the caldb dir?</li>
<li>URL for download additional ESAS CalDB files</li>
<li><a href="https://heasarc.gsfc.nasa.gov/docs/xmm/xmmhp_xmmesas.html">https://heasarc.gsfc.nasa.gov/docs/xmm/xmmhp_xmmesas.html</a></li>
<li>提前设置好${SAS_ESAS_CALDB}</li>
</ul>
<ol start="2">
<li>老李的script</li>
</ol>
<pre><code><code><div>usage:
    make_spectrum.sh det=&lt;detector&gt; regtxt=&lt;regtxt&gt; rootname=&lt;rootname&gt; grpcnts=&lt;group_mincounts&gt; [ccd#=0 or quad#=0]
detector: mos1,mos2,pn 
</div></code></code></pre>
<p>需要确保eventfile名字和esas手册中的mos/pn-spectra 和 mos/pn_back 需要的命名方法相同。 *-clean.fits</p>
<pre><code class="language-bash"><div>make_spectrum.sh det=mos1 regtxt=reg.txt rootname=annu1 grpcnts=50 ccd3=0 ccd6=0
make_spectrum.sh det=mos2 regtxt=reg1.txt rootname=annu1 grpcnts=50
make_spectrum.sh det=pn regtxt=reg1.txt rootname=annu1 grpcnts=50
</div></code></pre>
<hr>
<h1 id="4-有方向性的径向光谱多区域提取光谱">4. 有方向性的径向光谱/多区域提取光谱</h1>
<p>关于这节的简介：</p>
<ol>
<li>
<p>先用用其中一个image或eventfile画regs，保存成ciao,fk5的格式，分别加载到其他探测器或者其他obsid的images，然后在各自保存成的ciao格式的physical坐标，命名则是要包含、regname、obsid和detector name。比如我的命名法 [regname]_[obsid][PREFIX]phy.reg, example:
N_072385001mos1phy.reg。可以用脚本<code>wcs2phy.bash</code>处理.</p>
</li>
<li>
<p>让对应的 [regname]_[obsid][PREFIX]phy.reg 连接到 每个观测的 /[obsid]/PROC/reg/ 里</p>
</li>
<li>
<p>利用*phy.reg得到径向光谱拟合时需要的expressions.txt。DETXY坐标的一行一个径向区域expression。<br>
e.g EMOS1_E_0723800101mos1S001phy_sepexpr.txt。可以用<code>phy2reg.bash</code>处理.</p>
</li>
<li>
<p>然后把*sepexpr.txt连接到 PROC/[detector]/[regname]/ 文件夹中并且对这个symbolic的命名要根据需要命名，下面有文件夹意识图说明。</p>
</li>
<li>
<p>用xmm_spectrum.bash来进行光谱提取。done</p>
</li>
</ol>
<p>#文件夹意识图， 建议把*clean.fits link 到单独的PROC中的文件夹，以方便后续如果有很多不同区域的光谱提取。顺便建一个专门存放reg files是的文件夹reg。</p>
<pre><code><code><div>[obsid]/PROC/   
    -&gt; epsfilt/
        -&gt; *-clean.fits, *obj-image-[sky|det].fits,...
    -&gt; mos1/
        -&gt; symlink:mos*-clean.fits
        -&gt; N/
            -&gt; input requi: *.txt, symlink:*-clean.fits*
            -&gt; final output: *_grp.pi, *.rmf, *.arf, *_bkg.pi
            -&gt; ...
        -&gt; S/
        -&gt; ...
    -&gt; mos2/
        -&gt; N/
        -&gt; S/
        -&gt; ...
    -&gt; pn/
        -&gt; ...
    -&gt; reg/
        -&gt; *sepexpr.txt  ## 做光谱的区域,每行代表一个区域。
            -&gt; &amp;&amp;(DETX,DETY) in annulus(x,x,x)
            -&gt; &amp;&amp;(DETX,DETY) in annulus(x,x,x)
</div></code></code></pre>
<p>#吐槽： 如果有4个xmm观测，每个观测有3个EPIC detector，(i.g. mos1,mos2 and pn),那么总共就会有3×4=12个phy.reg files. 如果还做其他方向，比如共3个方向，就会有，36个phy.reg！！ 每个方向在有4个区域，那就有 144 个光谱omg！！</p>
<h2 id="41-xmm-radial-spectrum">4.1. XMM Radial spectrum</h2>
<ol>
<li>
<p>先用用其中一个image或eventfile画regs，保存成ciao,fk5的格式，</p>
<ul>
<li>这里我假设我选了一个向东的径向区域命名为<code>E_fk5.reg</code>.</li>
</ul>
</li>
<li>
<p>In NGC5846/profile2/<br>
分别加载到其他探测器或者其他obsid的images，然后在各自保存成的ciao格式的physical坐标，命名则是要包含、regname、obsid和detector name。比如我的命名法 [regname]_[obsid][PREFIX]phy.reg, example:
N_072385001mos1phy.reg。可以用脚本<code>wcs2phy.bash</code>处理.</p>
</li>
</ol>
<pre><code><code><div>NGC5846/profile2
-&gt; wcs_reg/
    -&gt; E_fk5.reg,N_fk5.reg
    -&gt; ...
-&gt; phy_reg
    -&gt; [REG]_[obsid][PREFIX]phy.reg
-&gt; [obsid]_dir (symbolic link)
    Ex: 788_dir-&gt;788/repro/, 0782300101_dir-&gt;PROC/espfilt
-&gt; [obsid][PREFIX]-clean.fits (symbolic link)
</div></code></code></pre>
<pre><code class="language-bash"><div>linkevtfile evtdirs=<span class="hljs-string">&quot;0021540101 0021540201&quot;</span>   
<span class="hljs-comment">##把每个光测的clean event files link 过来。(只能我用，除非命名和结构和我一样。)</span>

wcs2phy.bash evtfiles=<span class="hljs-string">&quot;`ls *-clean.fits`&quot;</span> regfiles=<span class="hljs-string">&quot;wcs_reg/[REG]_fk5.reg&quot;</span>  
<span class="hljs-comment">##把选好的fk5坐标的regfile变成phys,需要用到eventfiles</span>
<span class="hljs-comment">##需要用到ds9的功能。</span>
</div></code></pre>
<ol start="3">
<li>In [obsid]/PROC/reg/</li>
</ol>
<pre><code class="language-bash"><div><span class="hljs-comment">#产生需要的DET坐标的regtxt， 已filter expression形式记录区域, 命名为xxx.txt。（根据需要改phy2det中的命名）</span>
<span class="hljs-built_in">export</span> det=mos1; phy2det.bash evt=<span class="hljs-string">&#x27;`ls ../espfilt/*${det}*-obj-image-sky.fits`&#x27;</span> regfiles=<span class="hljs-string">&quot;`ls *<span class="hljs-variable">${det}</span>*phy.reg*`&quot;</span> sepexprfile=yes detreg=no exprfile=no  

<span class="hljs-built_in">export</span> det=mos2; phy2det.bash evt=<span class="hljs-string">&#x27;`ls ../espfilt/*${det}*-obj-image-sky.fits`&#x27;</span> regfiles=<span class="hljs-string">&quot;`ls *<span class="hljs-variable">${det}</span>*phy.reg*`&quot;</span> sepexprfile=yes detreg=no exprfile=no

<span class="hljs-built_in">export</span> det=pn; phy2det.bash evt=<span class="hljs-string">&#x27;`ls ../espfilt/*${det}*-obj-image-sky.fits`&#x27;</span> regfiles=<span class="hljs-string">&quot;`ls *<span class="hljs-variable">${det}</span>*phy.reg*`&quot;</span> sepexprfile=yes detreg=no exprfile=no
<span class="hljs-comment">#phy2det的脚本 generate 一种 *sepexpr.txt用于xmm的光谱提取脚本mos/pn-spectra中。</span>
</div></code></pre>
<ol start="4">
<li>In PROC/mos1/E<br>
把 E*-clean.fits 和 E*sepexpr.txt链接到这里.</li>
</ol>
<pre><code><code><div>ls
</div></code></code></pre>
<p>##检查链接有木有问题。可以用sas查看expression表示的区域，但是会有点麻烦，考虑写个脚本生成image。<br>
接下来用我写的 xmm_spectrum ，该脚本参照liweitian学长的make_spectrum。
##<code>注意 pn*-oot-clean.fits 也要link到pn/[REG]/的光谱文件夹中</code></p>
<pre><code class="language-bash"><div>time xmm_mkradialspectrum.bash det=mos1  regtxt=E_0723800101mos1.reg grpcnts=50 ccd3=0 ccd6=0 &gt; mos1-spec.log 2&lt;&amp;1 &amp;
</div></code></pre>
<ul>
<li>Note: 这里ccd3和6关闭了，所以设置成0。<code>xmm_mkradialspectrum.bash</code>这个脚本会跑<code>mos/pn-spectra</code>和<code>mos/pn_back</code>这两个脚本得到_grp.pi目标光谱和_bkg.pi背景光谱。</li>
</ul>
<h1 id="5-背景光谱修正">5. 背景光谱修正</h1>
<p>以下是李维天学长写的笔记 XMM_Background.md</p>
<pre><code>对于 XMM EPIC 背景光谱的处理，主要参考了 XMM-ESAS Cookbook [1]（主要源自论文 Snowden et al. 2008 [2]）。

背景主要包括以下 5 种成分 (文献 [2] Sec. 3)：
(1) Quiescent particle background (QPB): 连续谱，由高能粒子与探测器作用产生；
(2) Fluorescent X-rays (FX): 线辐射；粒子与仪器作用并被探测到；
(3) Soft proton background (SPB): 来自 soft protons 与探测器作用；随时间变化明显，通常也被称为 &quot;flares&quot;；
(4) Cosmic X-ray background (CXB): 包含银河系软 X 射线辐射，以及宇宙硬 X 射线辐射；
(5) Solar wind charge exchange emission (SWCX): 主要为线辐射，如 C[VI], O[VII], O[VIII].

我们使用了 ESAS [3] 提供的 mos-spectra / pn-spectra 来生成 MOS / PN 的目标区域的光谱和响应文件（RMF 与 ARF)，并使用 mos_back / pn_back 得到相应的 QPB 背景光谱，该背景光谱来自 filter wheel closed (FWC) 观测，与 Chandra 的 stowed background 类似。

对于背景成份 (2) 的辐射线，MOS 需要 2 个高斯模型(E ~ 1.49 keV, 1.75 keV)；PN 需要 6 个高斯模型(E ~ 1.49 keV, 7.11 keV, 7.49 keV, 8.05 keV, 8.62 keV, 8.90 keV)。注意，辐射线的位置需要拟合确定，如果简单地固定在这些值，则可能有明显的残差。

尽管通过分析光变曲线(lightcurve)，筛选时间段(GTI)，但仍然有部分残留的 SPB，这可以使用一个 unfolded (broken) powerlaw 来拟合。注意，SPB 因为未经过光路，所以该模型需要与上面的高斯模型以及下面的其他模型分离，只为该模型加载 RMF 而不要 ARF，或加载由 ESAS 提供的 *-diag.rsp。（XMM 对 HCG 62 的两次观测均有明显的 flares）

对于成分 (4)，与 Chandra 背景处理一致，使用两个 apec 模型(T = 0.08 keV, Z = 1.0, z = 0; T = 0.2 keV, Z = 1.0, z = 0)考虑银河系的软 X 射线辐射；以及 wabs*powerlaw (Gamma = 1.4)用于拟合宇宙硬 X 射线辐射。

背景成分 (5) SWCX 目前未考虑。

与顾力意 A1795 论文 [4] 中方法的不同之处：
a. 我们使用了 ESAS 提供的 FWC 数据来得到 QPB 背景光谱，而非使用一个 broken powerlaw 来近似（注意：该 powerlaw 与上面提到的 SPB 的 powerlaw 不同，而且两者的谱指数也有明显差异）
b. 我们额外考虑了残留的 SPB


具体的拟合模型为（还有 SPB 的模型未列出，详情参考 [1] Sec. 8.4）：
gauss+gauss+gauss+gauss+gauss+gauss+gauss + constant*constant*(apec+apec+ wabs*(powerlaw + apec))
o 前两个 gauss 模型对应 MOS 的两条辐射线
o 第一个和后面五个 gauss 模型对应 PN 的 6 条辐射线
o 第一个 constant 用于考虑 MOS1、MOS2 和 PN 之间的差异，通常在 1.0 附近
o 第二个 constant 对应于光谱提取区域的面积
o apec+apec+wabs*powerlaw 对应 CXB
o 最后的 wabs*apec 为目标星系群/团的气体辐射

首先在远离目标的外围区域提取本地背景背景拟合，确定辐射线的能量及宽度、 CXB 各模型的参数，以及 SPB 的谱指数。使用相同的模型拟合其他目标区域的光谱，但固定辐射线的能量及宽度、 CXB 各模型参数（包括 norm）和 SPB 的谱指数为之前的拟合值。拟合好之后，将目标气体辐射的 norm 值置为 0，然后 fake，并叠加到原来生成的 QPB 背景光谱，于是得到该区域的修正的背景光谱。

总的来说，XMM 的背景光谱处理与我们之前 Chandra 的背景光谱处理基本一致，除了以下三点差异：
a. XMM 需要考虑仪器辐射线
b. XMM 需要考虑残留的 SPB
c. XMM 需要对每个目标区域分别生成相应的修正背景光谱


[1] XMM-ESAS Cookbook: http://heasarc.gsfc.nasa.gov/docs/xmm/esas/cookbook/xmm-esas.html
[2] Snowden et al. 2008, A&amp;A, 478, 615-658: http://adsabs.harvard.edu/abs/2008A%26A...478..615S
[3] XMM-Newton Extended Source Analysis Software: https://heasarc.gsfc.nasa.gov/docs/xmm/xmmhp_xmmesas.html
[4] Gu et al. 2012, ApJ, 749, 186: http://adsabs.harvard.edu/abs/2012ApJ...749..186G</code></pre>

    </body>
    </html>